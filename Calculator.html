<!doctype html>
<html lang="en">

<head>
  <title> Calculator</title>
  <style>
    :root {
      --bg: #0b1020;
      --panel: #0f1724;
      --accent: #0ea5a4;
      --muted: #94a3b8;
      --btn-bg: #111827;
      --btn-light: #1f2937;
      --danger: #ef4444;
      --gap: 18px;
      --btn-size: 110px;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      background: #0b1020;
      font-family: Arial, Helvetica, sans-serif
    }

    .wrap {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px
    }

    .calc {
      width: calc(var(--btn-size)*4 + var(--gap)*3 + 80px);
      max-width: 96vw;
      background: #111827;
      border-radius: 20px;
      padding: 28px;
      box-shadow: 0 30px 80px rgba(2, 6, 23, 0.6);
      color: #e6eef6
    }

    .display {
      height: calc(var(--btn-size)*0.8);
      background: #0f1724;
      border-radius: 12px;
      padding: 18px 22px;
      font-size: 48px;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis
    }

    .keys {
      margin-top: 22px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-auto-rows: var(--btn-size);
      gap: var(--gap)
    }

    button {
      border: 0;
      border-radius: 14px;
      font-size: 32px;
      cursor: pointer;
      transition: transform .06s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none
    }

    button:active {
      transform: translateY(2px)
    }

    .btn-num {
      background: #1f2937;
      color: #e6eef6
    }

    .btn-op {
      background: #161b26;
      color: var(--accent)
    }

    .btn-equal {
      background: var(--accent);
      color: #032022;
      font-weight: 700
    }

    .btn-clear {
      background: #7a2b2b;
      color: #fff
    }

    .btn-wide {
      grid-column: span 2
    }
  </style>
</head>

<body>
  <div class="wrap">
    <main class="calc">
      <div id="display" class="display">0</div>
      <div class="keys">
        <button class="btn-clear" data-action="clear">C</button>
        <button class="btn-op" data-action="back">⌫</button>
        <button class="btn-op" data-action="percent">%</button>
        <button class="btn-op" data-action="/">÷</button>
        <button class="btn-num" data-value="7">7</button>
        <button class="btn-num" data-value="8">8</button>
        <button class="btn-num" data-value="9">9</button>
        <button class="btn-op" data-action="*">×</button>
        <button class="btn-num" data-value="4">4</button>
        <button class="btn-num" data-value="5">5</button>
        <button class="btn-num" data-value="6">6</button>
        <button class="btn-op" data-action="-">−</button>
        <button class="btn-num" data-value="1">1</button>
        <button class="btn-num" data-value="2">2</button>
        <button class="btn-num" data-value="3">3</button>
        <button class="btn-op" data-action="+">+</button>
        <button class="btn-num btn-wide" data-value="0">0</button>
        <button class="btn-num" data-value=".">.</button>
        <button class="btn-equal" data-action="=">=</button>
      </div>
    </main>
  </div>
  <script>
    (() => {
      const display = document.getElementById('display');
      const keys = document.querySelector('.keys');
      let expr = '';
      function updateDisplay() { display.textContent = expr || '0' }
      function append(value) { if (expr === '0' && value !== '.') expr = value; else expr += value; updateDisplay() }
      function safeEval(input) {
        if (!/^[0-9+\-*/().%\s]+$/.test(input)) return 'Error';
        try {
          const sanitized = input.replace(/(\d+(\.\d+)?)%/g, '($1/100)');
          const result = Function('"use strict";return(' + sanitized + ')')();
          if (result === Infinity || result === -Infinity || Number.isNaN(result)) return 'Error';
          if (Number.isInteger(result)) return String(result);
          return String(parseFloat(result.toFixed(8)));
        } catch (e) { return 'Error' }
      }
      keys.addEventListener('click', e => {
        const btn = e.target.closest('button'); if (!btn) return;
        const val = btn.dataset.value; const action = btn.dataset.action;
        if (val !== undefined) { append(val); return }
        if (action) {
          if (action === 'clear') { expr = ''; updateDisplay(); return }
          if (action === 'back') { expr = expr.slice(0, -1); updateDisplay(); return }
          if (action === '=') { const res = safeEval(expr); expr = (res === 'Error') ? '' : String(res); updateDisplay(); return }
          append(action)
        }
      });
      window.addEventListener('keydown', e => {
        if (e.key >= '0' && e.key <= '9') append(e.key);
        else if (['+', '-', '*', '/', '(', ')', '.'].includes(e.key)) append(e.key);
        else if (e.key === 'Enter') { const res = safeEval(expr); expr = (res === 'Error') ? '' : String(res); updateDisplay() }
        else if (e.key === 'Backspace') { expr = expr.slice(0, -1); updateDisplay() }
        else if (e.key === 'Escape') { expr = ''; updateDisplay() }
      })
    })();
  </script>
</body>

</html>